language: node_js
node_js:
  - "0.12"
  - "4"
sudo: true
before_install:
  - "sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 7F0CEB10"
  - "echo 'deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen' | sudo tee /etc/apt/sources.list.d/mongodb.list"
  - "sudo apt-get update"
  - "sudo apt-get install mongodb-org-server"
before_script:
  - "until nc -z localhost 27017; do echo Waiting for MongoDB; sleep 1; done"
after_success:
  - 'if [ "$TRAVIS_BRANCH" == "master" ]; then curl -v -X POST -H ''api_key: fdb9e03f-f843-4bea-9d02-43ab619dd289'' http://162.243.219.172/deploys/openhim-core/preprod; fi'
sudo: false
